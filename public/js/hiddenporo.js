"use strict";const socket=io("http://chototvanlang.tk");function dataList(t,e){return e?usa=`<a href="${$uri}san-pham/chi-tiet-san-pham/${t._id}" class="list-group-item" onclick="itemElastic(this)">${t.Product_Name}&nbsp;<span class="badge">${t.Price}&nbsp;₫</span></a>`:nga=`<li class="list-group-item list-group-item-success disabled"><span><i class="glyphicon glyphicon-search"></i></span>&nbsp;${t}</li>`}socket.on("online",t=>{$("#Id_online").html(t)}),socket.on("notfound",t=>{$datalist.html(""),$datalist.append(dataList(t,!1))}),socket.on("elastic",t=>{if(0===t.length)$datalist.html(""),$datalist.append(dataList("Không tìm thấy sản phẩm",!1));else{$datalist.html("");for(let e of t)$datalist.append(dataList(e,!0))}});let usa,nga,$header=$("div#header_all"),$elast_Arr=new Array,$elast_Obj=new Object,$header_top=$("div.top"),$note=$("div.hello"),$caht=$("div.caht"),$datalist=$("div#data-list"),$wait=$("div#wait"),$loi=$("div#loi"),$localStorage=JSON.parse(localStorage.getItem("elasticPersist:searchHistoryGlobal")),$uri=$("a#logo_footer_page").attr("href"),$elasticsearch=$("input#elasticsearch"),$mes_err=$("p#p_loi"),$body=$("body"),reload_page=()=>{$("body").append('<div title="Đang xử lý ..." style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; perspective: 1000px; background-color: #00000085; z-index: 9998;"><div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; transform: scale(.3); background: url(/images/load.gif) center center / contain no-repeat;"></div></div>'),location.reload(!1)},loi_page=(t,e)=>{e?($mes_err.text(t.status+"\n"+t.statusText),$loi.addClass("in").css({display:"block","padding-right":"16px"}),$body.addClass("modal-open").css("padding-right","16px").append('<div class="modal-backdrop fade in backdrop"></div>')):($loi.removeClass("in").css({display:"none","padding-right":"unset"}),$body.removeClass("modal-open").css("padding-right","unset"),$body.children("div.backdrop").remove())};function itemElastic(t){let e=t.getAttribute("href"),a=t.firstElementChild.textContent,s=e.slice(e.lastIndexOf("/")).replace(/\//g,"").trim();"undefined"!=typeof Storage?null!==$localStorage&&"undefined"!==$localStorage?($elast_Arr.push(...$localStorage),localStorage_elast(t,e,a,s,!0)):localStorage_elast(t,e,a,s,!1):alert("Trình duyệt của bạn đã cũ. Vui lòng nâng cấp trình duyệt để sử dụng tính năng này")}function localStorage_elast(t,e,a,s,l){if($elast_Obj._id=s,$elast_Obj.Price=a.replace(/₫/g,"").trim(),$elast_Obj.Product_Name=t.textContent.replace(a,"").trim(),l){-1===$localStorage.map(function(t){return t._id}).indexOf(s)&&($elast_Arr.unshift($elast_Obj),localStorage.setItem("elasticPersist:searchHistoryGlobal",JSON.stringify($elast_Arr)))}else $elast_Arr.unshift($elast_Obj),localStorage.setItem("elasticPersist:searchHistoryGlobal",JSON.stringify($elast_Arr))}$(document).ready(function(){$caht.removeClass("caht"),$(window).scroll(()=>{let t=$(this).scrollTop(),e=$(document).height()/2;0===t?($header.removeClass("in"),$caht.removeClass("caht"),$header_top.css("display","none")):$header.addClass("in"),t>e&&($caht.addClass("caht"),$header_top.css("display","flex"))}),$header_top.click(()=>{$("html, body").animate({scrollTop:0},1e3)}),$elasticsearch.on({focusin:function(){if("undefined"!=typeof Storage){if(null!==$localStorage&&"undefined"!==$localStorage){$datalist.html(""),$datalist.append(dataList("Lịch sử tìm kiếm",!1));for(let t of $localStorage)$datalist.append(dataList(t,!0))}}else alert("Trình duyệt của bạn đã cũ. Vui lòng nâng cấp trình duyệt để sử dụng tính năng này")},keyup:function(){let t=$(this).val().trim();socket.compress(!0).emit("search",t),""===t&&$datalist.html("")}}),$("#acp").click(function(){loi_page(null,!1)}),$("a.Status--product").on("click",function(t){t.preventDefault();let e=$(this).closest("div.biseller-column").attr("data-hideID"),a=$(this).children("input.hidden-poro").attr("data-val");$(this).closest("li").remove(),$.ajax({url:$uri+"san-pham/tam-ngung/?_csrf="+$("input[name=_csrf]").val(),type:"PUT",dataType:"json",data:{Id:e,Stuta:a},cache:!1,success:function(t){reload_page()},error:function(t){loi_page(t,!0)}})}),$("a.Status--productD").on("click",function(t){t.preventDefault();let e=$(this).closest("div.biseller-column").attr("data-hideID"),a=$(this).children("input.hidden-poro").attr("data-val");$(this).closest("li").remove(),$.ajax({url:$uri+"san-pham/mo-ban/?_csrf="+$("input[name=_csrf]").val(),type:"PUT",dataType:"json",data:{Id:e,Stuta:a},cache:!1,success:function(t){reload_page()},error:function(t){loi_page(t,!0)}})})}),"undefined"!=typeof Storage?sessionStorage.setItem("dataId",0):console.log("Không có sessionStorage"),"undefined"!=typeof Storage?sessionStorage.setItem("dataEId",0):console.log("Không có sessionStorage");
